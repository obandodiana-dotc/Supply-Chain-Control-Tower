<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>SupplyChain Intelligence Â· Inventory Simulation</title>

<style>
  :root {
    --bg: #0a0f1c;
    --card: #131b2f;
    --soft: #1c2640;
    --accent: #38bdf8;
    --accent2: #34d399;
    --warn: #facc15;
    --danger: #fb7185;
    --text: #e2e8f0;
    --text-soft: #94a3b8;
    --radius: 18px;
    --radius-sm: 10px;
    --font: system-ui, sans-serif;
  }

  * { margin:0; padding:0; box-sizing:border-box; font-family:var(--font); }

  body {
    background: var(--bg);
    color: var(--text);
    padding-bottom: 50px;
  }

  nav {
    width: 100%;
    background: var(--card);
    padding: 14px;
    display: flex;
    justify-content: center;
    gap: 22px;
    position: sticky;
    top: 0;
    z-index: 99;
    border-bottom: 1px solid #1e293b;
  }
  nav a {
    color: var(--text-soft);
    text-decoration: none;
    font-weight: 500;
  }
  nav a:hover { color: var(--accent); }

  .container {
    max-width: 960px;
    margin: auto;
    padding: 20px;
  }

  h1 {
    text-align: center;
    font-size: 32px;
    margin-bottom: 6px;
    background: linear-gradient(to right, #38bdf8, #a855f7, #f97316);
    -webkit-background-clip: text;
    color: transparent;
  }

  .subtitle {
    text-align:center;
    font-size:14px;
    color:var(--text-soft);
    margin-bottom:20px;
  }

  .card {
    background: var(--card);
    padding: 16px;
    border-radius: var(--radius);
    border: 1px solid #1e293b;
    margin-top: 26px;
  }

  .row { display:flex; justify-content:space-between; margin-top:8px; }
  .label { color:var(--text-soft); font-size:14px; }
  .value { font-weight:600; }

  input {
    width:100%;
    padding:10px;
    margin-top:6px;
    background: var(--soft);
    border:1px solid #24314d;
    border-radius: var(--radius-sm);
    color: var(--text);
  }

  .btn {
    background: var(--accent);
    color:#000;
    padding:12px;
    border-radius: var(--radius);
    text-align:center;
    font-weight:600;
    margin-top:16px;
    cursor:pointer;
  }

  canvas {
    width:100%;
    height:300px;
    margin-top:20px;
    background:#111827;
    border-radius: var(--radius-sm);
    border:1px solid #24314d;
  }

  .tag {
    padding:3px 8px;
    border-radius:999px;
    width:fit-content;
    font-size:12px;
    margin-top:4px;
  }
  .green {background:rgba(34,197,94,0.15); color:#bbf7d0;}
  .yellow {background:rgba(250,204,21,0.15); color:#fef9c3;}
  .red {background:rgba(248,113,113,0.15); color:#fee2e2;}

</style>
</head>

<body>

<!-- NAV -->
<nav>
  <a href="index.html">Dashboard</a>
  <a href="inventory.html">Inventory</a>
  <a href="map.html">Network Map</a>
  <a href="simulation.html">Simulation</a>
  <a href="risk.html">Risk</a>
  <a href="abc.html">ABC</a>
</nav>

<div class="container">

  <h1>Inventory Simulation</h1>
  <p class="subtitle">Day-by-day performance under demand variability</p>

  <!-- INPUT PANEL -->
  <div class="card">
    <h3>Simulation Parameters</h3>

    <div class="row">
      <span class="label">Initial Inventory</span>
      <input id="inv0" type="number" value="500">
    </div>

    <div class="row">
      <span class="label">Daily Mean Demand</span>
      <input id="mean" type="number" value="40">
    </div>

    <div class="row">
      <span class="label">Daily Std Dev</span>
      <input id="std" type="number" value="10">
    </div>

    <div class="row">
      <span class="label">Lead Time (days)</span>
      <input id="lt" type="number" value="7">
    </div>

    <div class="row">
      <span class="label">Reorder Point</span>
      <input id="rop" type="number" value="180">
    </div>

    <div class="row">
      <span class="label">Order Quantity</span>
      <input id="q" type="number" value="300">
    </div>

    <div class="btn" onclick="runSimulation()">Run Simulation</div>
  </div>

  <!-- KPI CARD -->
  <div class="card" id="kpiCard" style="display:none;">
    <h3>Results Summary</h3>

    <div class="row">
      <span class="label">Days Simulated</span>
      <span class="value" id="kpiDays"></span>
    </div>

    <div class="row">
      <span class="label">Stockout Days</span>
      <span class="value" id="kpiStockout"></span>
    </div>

    <div class="row">
      <span class="label">Total Orders Placed</span>
      <span class="value" id="kpiOrders"></span>
    </div>
  </div>

  <!-- CHART -->
  <canvas id="simChart"></canvas>

</div>

<script src="data.js"></script>

<script>
/* ============================================================
   NORMAL RANDOM DEMAND GENERATOR (approx)
   ============================================================ */
function randomNormal(mean, std) {
  let u = Math.random();
  let v = Math.random();
  let z = Math.sqrt(-2 * Math.log(u)) * Math.cos(2 * Math.PI * v);
  return Math.max(0, Math.round(mean + std * z));
}

/* ============================================================
   MAIN SIMULATION
   ============================================================ */
function runSimulation() {
  const inv0 = Number(document.getElementById("inv0").value);
  const mean = Number(document.getElementById("mean").value);
  const std = Number(document.getElementById("std").value);
  const LT = Number(document.getElementById("lt").value);
  const ROP = Number(document.getElementById("rop").value);
  const Q = Number(document.getElementById("q").value);

  const days = 60;
  let inventory = inv0;
  let incomingOrders = [];

  let invHistory = [];
  let demandHistory = [];

  let stockouts = 0;
  let ordersPlaced = 0;

  for (let day = 0; day < days; day++) {

    // Arrivals
    for (let i = incomingOrders.length - 1; i >= 0; i--) {
      incomingOrders[i].lt--;
      if (incomingOrders[i].lt <= 0) {
        inventory += incomingOrders[i].qty;
        incomingOrders.splice(i, 1);
      }
    }

    // Demand
    let demandToday = randomNormal(mean, std);
    demandHistory.push(demandToday);

    if (inventory >= demandToday) {
      inventory -= demandToday;
    } else {
      stockouts++;
      inventory = 0;
    }

    // Reorder
    if (inventory <= ROP) {
      incomingOrders.push({ qty: Q, lt: LT });
      ordersPlaced++;
    }

    invHistory.push(inventory);
  }

  /* Update KPI card */
  document.getElementById("kpiDays").textContent = days;
  document.getElementById("kpiStockout").textContent = stockouts;
  document.getElementById("kpiOrders").textContent = ordersPlaced;
  document.getElementById("kpiCard").style.display = "block";

  drawChart(invHistory, demandHistory);
}

/* ============================================================
   DRAW CANVAS CHART
   ============================================================ */
function drawChart(inv, demand) {
  const canvas = document.getElementById("simChart");
  const ctx = canvas.getContext("2d");

  canvas.width = canvas.clientWidth * 2;
  canvas.height = 300 * 2;

  ctx.scale(2,2);

  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw axes
  ctx.strokeStyle = "#334155";
  ctx.lineWidth = 2;

  ctx.beginPath();
  ctx.moveTo(40, 10);
  ctx.lineTo(40, 260);
  ctx.lineTo(620, 260);
  ctx.stroke();

  // Plot inventory line
  ctx.strokeStyle = "#38bdf8";
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(40, 260 - inv[0]);

  for (let i = 1; i < inv.length; i++) {
    ctx.lineTo(40 + i * 10, 260 - inv[i]);
  }
  ctx.stroke();

  // Plot demand line
  ctx.strokeStyle = "#34d399";
  ctx.beginPath();
  ctx.moveTo(40, 260 - demand[0]);

  for (let i = 1; i < demand.length; i++) {
    ctx.lineTo(40 + i * 10, 260 - demand[i]);
  }
  ctx.stroke();

}
</script>

</body>
</html>
